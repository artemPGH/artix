<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>ARTIX</title>

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    min-height: 100vh;
    background: radial-gradient(circle at top, #050716, #020308 60%, #000);
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #e5e7eb;
}

.app {
    width: 100%;
    max-width: 760px;
    background: rgba(8,10,26,.96);
    border-radius: 20px;
    padding: 22px;
    box-shadow:
        0 0 40px rgba(0,0,0,.8),
        0 0 80px rgba(88,166,255,.18);
    border: 1px solid rgba(255,255,255,.06);
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.title {
    font-size: 26px;
    letter-spacing: .14em;
}

.subtitle {
    font-size: 12px;
    opacity: .7;
}

.mode {
    display: inline-flex;
    background: rgba(15,23,42,.9);
    border-radius: 999px;
    padding: 4px;
    border: 1px solid rgba(148,163,184,.4);
}

.mode button {
    background: none;
    border: none;
    color: #cbd5f5;
    font-size: 11px;
    padding: 6px 12px;
    border-radius: 999px;
    cursor: pointer;
}

.mode button.active {
    background: linear-gradient(135deg,#4f46e5,#06b6d4);
    color: #fff;
    box-shadow: 0 0 12px rgba(99,102,241,.7);
}

.chat {
    height: 300px;
    overflow-y: auto;
    background: rgba(15,23,42,.9);
    border-radius: 12px;
    padding: 10px;
    border: 1px solid rgba(30,64,175,.5);
    margin-bottom: 10px;
}

.msg {
    margin-bottom: 8px;
    line-height: 1.4;
}

.msg.user { text-align: right; }

.msg span {
    display: inline-block;
    padding: 7px 11px;
    border-radius: 12px;
    max-width: 90%;
}

.msg.user span {
    background: linear-gradient(135deg,rgba(59,130,246,.35),rgba(8,47,73,.9));
}

.msg.bot span {
    background: linear-gradient(135deg,rgba(16,185,129,.25),rgba(15,23,42,.95));
}

pre {
    background: rgba(15,23,42,.95);
    padding: 8px;
    border-radius: 8px;
    overflow-x: auto;
    margin-top: 6px;
    border: 1px solid rgba(75,85,99,.8);
}

.input {
    display: flex;
    gap: 8px;
}

input {
    flex: 1;
    padding: 10px;
    border-radius: 10px;
    border: 1px solid rgba(148,163,184,.6);
    background: rgba(15,23,42,.95);
    color: #fff;
    outline: none;
}

button.send {
    padding: 10px 16px;
    border-radius: 10px;
    border: none;
    background: linear-gradient(135deg,#4f46e5,#06b6d4);
    color: #fff;
    font-weight: 600;
    cursor: pointer;
}
</style>
</head>

<body>
<div class="app">

<div class="header">
    <div>
        <div class="title">ARTIX</div>
        <div class="subtitle">умный ассистент</div>
    </div>
    <div class="mode">
        <button id="modeGeneral" class="active">Обычный</button>
        <button id="modePython">Python</button>
    </div>
</div>

<div id="chat" class="chat"></div>

<div class="input">
    <input id="input" placeholder="Задай вопрос…" />
    <button class="send" onclick="send()">Отправить</button>
</div>

</div>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("input");
const btnGeneral = document.getElementById("modeGeneral");
const btnPython = document.getElementById("modePython");

let mode = "general";

// ---------------- UI ----------------
function add(text, from="bot", html=false){
    const div = document.createElement("div");
    div.className = "msg " + from;
    const span = document.createElement("span");
    html ? span.innerHTML = text : span.textContent = text;
    div.appendChild(span);
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
}

// ---------------- SYSTEM INTELLIGENCE ----------------
function systemAnswer(q){
    q = q.toLowerCase();
    if(q.includes("какой сегодня день") || q.includes("какая сегодня дата")){
        return new Date().toLocaleDateString("ru-RU",{weekday:"long",year:"numeric",month:"long",day:"numeric"});
    }
    if(q.includes("который час") || q.includes("сколько времени")){
        return "Сейчас " + new Date().toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"});
    }
    return null;
}

// ---------------- WIKIPEDIA ----------------
async function wiki(query){
    const s = await fetch(`https://ru.wikipedia.org/w/rest.php/v1/search/title?q=${encodeURIComponent(query)}&limit=1`);
    const js = await s.json();
    if(!js.pages || !js.pages.length) return null;

    const title = js.pages[0].title;
    const sum = await fetch(`https://ru.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(title)}`);
    const data = await sum.json();

    const text = data.extract?.split(". ").slice(0,4).join(". ") + ".";
    return `
<b>${data.title}</b><br><br>
${text}
<div style="opacity:.5;font-size:11px;margin-top:4px">
источник: <a href="${data.content_urls.desktop.page}" target="_blank">Wikipedia</a>
</div>`;
}

// ---------------- STACKOVERFLOW ----------------
async function stack(query){
    const r = await fetch(`https://api.stackexchange.com/2.3/search/advanced?order=desc&sort=relevance&answers=1&tagged=python&site=stackoverflow&pagesize=1&q=${encodeURIComponent(query)}`);
    const d = await r.json();
    if(!d.items || !d.items.length) return null;

    const i = d.items[0];
    return `
<b>${i.title}</b><br><br>
Это популярный вопрос по Python. Обычно в таких обсуждениях объясняют причину проблемы и приводят рабочие примеры кода.
<div style="opacity:.5;font-size:11px;margin-top:4px">
подробнее: <a href="${i.link}" target="_blank">StackOverflow</a>
</div>`;
}

// ---------------- MAIN LOGIC ----------------
async function send(){
    const q = input.value.trim();
    if(!q) return;
    add(q,"user");
    input.value = "";

    const sys = systemAnswer(q);
    if(sys){
        add(sys);
        return;
    }

    add("Думаю…","bot");

    let answer = null;
    if(mode==="general") answer = await wiki(q);
    else answer = await stack(q);

    chat.lastChild.remove();

    if(answer) add(answer,"bot",true);
    else add("Я не смог найти полезную информацию. Попробуй переформулировать вопрос.");
}

// ---------------- MODES ----------------
btnGeneral.onclick = ()=>{
    mode="general";
    btnGeneral.classList.add("active");
    btnPython.classList.remove("active");
    add("Обычный режим включён. Я объясняю понятия и читаю статьи.","bot");
};

btnPython.onclick = ()=>{
    mode="python";
    btnPython.classList.add("active");
    btnGeneral.classList.remove("active");
    add("Python-режим включён. Я ищу решения и объясняю ошибки.","bot");
};

// start
add("Привет! Я ARTIX. Задай вопрос или выбери режим Python.","bot");
</script>
</body>
</html>
